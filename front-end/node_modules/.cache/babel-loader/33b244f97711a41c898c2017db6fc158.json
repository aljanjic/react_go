{"ast":null,"code":"import _defineProperty from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/aljani/projects/react_go/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import Input from\"./form-components/Input\";import Alert from\"./ui-components/Alert\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.handleChange=function(evt){var value=evt.target.value;var name=evt.target.name;_this.setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},name,value));});};_this.handleSubmit=function(evt){evt.preventDefault();var errors=[];if(_this.state.email===\"\"){errors.push(\"email\");}if(_this.state.password===\"\"){errors.push(\"password\");}_this.setState({errors:errors});if(errors.length>0){return false;}var data=new FormData(evt.target);var payload=Object.fromEntries(data.entries());var requestOptions={method:\"POST\",body:JSON.stringify(payload)};fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/v1/signin\"),requestOptions).then(function(response){return response.json();}).then(function(data){if(data.error){_this.setState({alert:{type:\"alert-danger\",message:data.error.message}});}else{console.log(data);_this.handleJWTChange(Object.values(data)[0]);window.localStorage.setItem(\"jwt\",JSON.stringify(Object.values(data)[0]));_this.props.history.push({pathname:\"/admin\"});}});};_this.state={email:\"\",password:\"\",error:null,errors:[],alert:{type:\"d-none\",message:\"\"}};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(Login,[{key:\"handleJWTChange\",value:function handleJWTChange(jwt){this.props.handleJWTChange(jwt);}},{key:\"hasError\",value:function hasError(key){return this.state.errors.indexOf(key)!==-1;}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Alert,{alertType:this.state.alert.type,alertMessage:this.state.alert.message}),/*#__PURE__*/_jsxs(\"form\",{className:\"pt-3\",onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(Input,{title:\"Email\",type:\"email\",name:\"email\",handleChange:this.handleChange,className:this.hasError(\"email\")?\"is-invalid\":\"\",errorDiv:this.hasError(\"email\")?\"text-danger\":\"d-none\",errorMsg:\"Please enter a valid email address\"}),/*#__PURE__*/_jsx(Input,{title:\"Password\",type:\"password\",name:\"password\",handleChange:this.handleChange,className:this.hasError(\"password\")?\"is-invalid\":\"\",errorDiv:this.hasError(\"password\")?\"text-danger\":\"d-none\",errorMsg:\"Please enter a password\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",children:\"Login\"})]})]});}}]);return Login;}(Component);export{Login as default};","map":{"version":3,"sources":["/home/aljani/projects/react_go/front-end/src/components/Login.js"],"names":["React","Component","Fragment","Input","Alert","Login","props","handleChange","evt","value","target","name","setState","prevState","handleSubmit","preventDefault","errors","state","email","push","password","length","data","FormData","payload","Object","fromEntries","entries","requestOptions","method","body","JSON","stringify","fetch","process","env","REACT_APP_API_URL","then","response","json","error","alert","type","message","console","log","handleJWTChange","values","window","localStorage","setItem","history","pathname","bind","jwt","key","indexOf","hasError"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport Input from \"./form-components/Input\";\nimport Alert from \"./ui-components/Alert\";\n\nexport default class Login extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      email: \"\",\n      password: \"\",\n      error: null,\n      errors: [],\n      alert: {\n        type: \"d-none\",\n        message: \"\",\n      },\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleChange = (evt) => {\n    let value = evt.target.value;\n    let name = evt.target.name;\n    this.setState((prevState) => ({\n      ...prevState,\n      [name]: value,\n    }));\n  };\n\n  handleSubmit = (evt) => {\n    evt.preventDefault();\n\n    let errors = [];\n\n    if (this.state.email === \"\") {\n        errors.push(\"email\");\n    }\n\n    if (this.state.password === \"\") {\n        errors.push(\"password\");\n    }\n\n    this.setState({errors: errors});\n\n    if (errors.length > 0) {\n        return false;\n    }\n\n    const data = new FormData(evt.target);\n    const payload = Object.fromEntries(data.entries());\n\n    const requestOptions = {\n        method: \"POST\",\n        body: JSON.stringify(payload),\n    }\n\n    fetch(`${process.env.REACT_APP_API_URL}/v1/signin`, requestOptions)\n        .then((response) => response.json())\n        .then((data) => {\n            if (data.error) {\n                this.setState({\n                    alert: {\n                        type: \"alert-danger\",\n                        message: data.error.message,\n                    }\n                })\n            } else {\n                console.log(data);\n                this.handleJWTChange(Object.values(data)[0]);\n                window.localStorage.setItem(\"jwt\", JSON.stringify(Object.values(data)[0]));\n                this.props.history.push({\n                    pathname: \"/admin\",\n                })\n            }\n        })\n\n  };\n\n  handleJWTChange(jwt) {\n      this.props.handleJWTChange(jwt);\n  }\n\n  hasError(key) {\n    return this.state.errors.indexOf(key) !== -1;\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <h2>Login</h2>\n        <hr />\n        <Alert\n          alertType={this.state.alert.type}\n          alertMessage={this.state.alert.message}\n        />\n\n        <form className=\"pt-3\" onSubmit={this.handleSubmit}>\n          <Input\n            title={\"Email\"}\n            type={\"email\"}\n            name={\"email\"}\n            handleChange={this.handleChange}\n            className={this.hasError(\"email\") ? \"is-invalid\" : \"\"}\n            errorDiv={this.hasError(\"email\") ? \"text-danger\" : \"d-none\"}\n            errorMsg={\"Please enter a valid email address\"}\n          />\n\n          <Input\n            title={\"Password\"}\n            type={\"password\"}\n            name={\"password\"}\n            handleChange={this.handleChange}\n            className={this.hasError(\"password\") ? \"is-invalid\" : \"\"}\n            errorDiv={this.hasError(\"password\") ? \"text-danger\" : \"d-none\"}\n            errorMsg={\"Please enter a password\"}\n          />\n\n          <hr />\n          <button className=\"btn btn-primary\">Login</button>\n        </form>\n      </Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}